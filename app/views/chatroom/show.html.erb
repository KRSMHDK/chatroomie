<div class="container" data-controller="messages">
  <h1 class="text-center mb-5">Chatroom</h1>
  <div class="row">
    <div class="col-md-3">
      <h4>Users</h4>
      <ul class="list-group">
        <li class="list-group-item">User 1</li>
        <li class="list-group-item">User 2</li>
        <li class="list-group-item">User 3</li>
      </ul>
    </div>
    <div class="col-md-9">
      <div class="chat-container">
        <div class="chatbox">
          <%= turbo_stream_from @room %>
          <%= render partial: "messages/message", collection: @messages %>
          <div id="messages">
          </div>
        </div>
        <%= form_with url: messages_url, local:false, remote: true do |form| %>
          <div class="form-group">
            <%= form.hidden_field :user_id, value: current_user.id %>
            <%= form.hidden_field :room_id, value: @room.id %>
            <%= current_user.name %>
            <%= form.text_field :content, placeholder: "Enter your message here...", class: "field" %>
            <%= form.submit data: { disable_with: false }, class:"btn btn-primary chat-message" %>
          <% end %>
          <%= action_cable_meta_tag %>
        </div>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
  function scroll_bottom() {
    var chatbox = document.querySelector('.chatbox');
    chatbox.scrollTop = chatbox.scrollHeight;
  }

  document.addEventListener('turbo:load', function() {
  scroll_bottom();
  });
</script>
